



## 推断

```bash
python3 inference_video.py --exp=1 --video=video.mp4 

```



默认的权重文件在train_log里





训练命令

```bash
python -m torchrun train.py --world_size=1 --local_rank=0

screen -S egy_train torchrun train.py --world_size=1 --local_rank=0 --batch_size=64
```



### 结果记录

使用项目训练代码，vimeo数据集训练复现，得到模型权重参数，在多个中测试结果如下：

vimeo_interp_test

Avg PSNR: 35.035979413110226 SSIM: 0.9756986498832703



UCF100 测试集

Avg PSNR: 35.24737353269929 SSIM: 0.9689498543739319



ATD12K_test

Avg PSNR: 28.775512916087578 SSIM: 0.9535548686981201







## benchmark使用

在benchmark中写好了不同数据集的测试代码，注意修改其中读取模型的目录，以及数据集的目录。

###### 

## 代码梳理

模型

RIFE 整体模型

IFNet 光流预测网络







作者在论文中描述的IFNet是用来预测光流的，其结构由三个IFBlock组成。

IFNet.py文件中为IFNet模型相关代码。IFBlock类 定义了作者在论文中提出的**IFNet**的小模块





在refine中的Unet定义的forward中进行融合
